{% extends "base.html" %}
{% from "components/button.html" import button %}
{% from "components/scroll_card.html" import scroll_card %}
{% from "components/subject_card.html" import subject_card %}
{% from "components/search_form.html" import search_form %}
{% from "components/verification_banner.html" import verification_banner %}

{% block title %}Home - Scroll Press{% endblock %}

{% block content %}
{% if show_verification_notice %}
{{ verification_banner() }}
{% endif %}
<div class="hero">
  <div class="hero-title">
    <img src="/brand/logos/press/press-logo-64.svg" alt="Scroll Press">
    <h1>Scroll Press</h1>
  </div>
  <p class="hero-tagline">A preprint server for interactive research papers.</p>
  <p class="hero-subtitle">Interactive visualizations. Live figures. Permanent DOIs. Free forever.</p>

  <div class="search-box">
    {{ search_form(button_class="search-btn-override") }}
    <div class="search-help">
      Search includes titles, authors, abstracts, and full text
    </div>
  </div>
</div>

<div class="subjects" id="browse">
  <div class="subjects-header">
    <h2>Browse by Subject</h2>
    <button
      type="button"
      id="show-all-btn"
      class="show-all-btn active"
      hx-get="/partials/scrolls"
      hx-target="#scrolls-section"
      hx-swap="innerHTML"
      hx-push-url="/"
    >
      Show All
    </button>
  </div>
  <div class="subject-grid">
    {% for subject in subjects %}
    {% if subject.scroll_count > 0 %}
    {{ subject_card(subject.name, subject.scroll_count) }}
    {% endif %}
    {% endfor %}
  </div>
</div>

<div class="recent" id="recent">
  <div id="scrolls-section">
    <h2 id="recent-submissions-heading">Recent Scrolls</h2>

    <div id="scrolls-grid" class="scrolls-grid">
      {% for preview_row in scrolls %}
      {% set preview = preview_row[0] %}
      {% set subject_name = preview_row[1] %}
      {{ scroll_card(
                      preview.title,
                      preview.authors,
                      preview.abstract,
                      preview.keywords,
                      subject_name,
                      "recently",
                      "v" + preview.version|string,
                      preview.url_hash
         ) }}
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
